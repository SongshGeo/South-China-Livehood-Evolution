---
title: 配置文件
author: Shuang Song
---

配置文件是模型运行的重要组成部分。模型运行时，会根据配置文件中的参数进行模拟。配置文件的格式为YAML，用户可以在配置文件中修改模型参数。

配置文件的默认位置为`config/config.yaml`，用户也可以在运行模型时通过命令行参数指定配置文件的位置。例如：

## 配置文件结构

配置文件主要分为以下几个部分：

### exp

实验配置，包括实验名称、重复次数、进程数、绘图变量等。

| 参数名 | 类型 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- |
| name | str | - | 实验名称 |
| repeats | int | 1 | 每组参数的重复次数 |
| num_process | int | 1 | 并行运算的进程数 |
| plot_heatmap | str | - | [绘制热图]的变量 |

### model

模型配置，包括模型参数，如竞争失败者的人口损失系数、断点检测方法等。

| 参数名 | 类型 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- |
| save_plots | bool | True | 是否保存绘图 |
| loss_rate | float | 0.5 | 竞争失败者的人口损失系数 |
| n_bkps | int | 1 | [断点数量] |
| detect_bkp_by | str | 'size' | [断点检测方法] |

### reports

决定了报告的输出内容，包括报告的名称、报告的变量等。变量命名规则为 `{report_type}_{group}_{variable_type}`，例如：

- `len_farmers`: 农民，团体数，占总人口比例
- `num_farmers_n`: 农民，人口数，绝对人口数量

- 报告名称包括：
  - `model`: 模型报告，单次实验每个时间步都记录的变量
  - `final`: 实验报告，每次实验只在结束时记录的变量
- 主体包括：
  - `farmers`: 农民
  - `hunters`: 狩猎采集者
  - `rice`: 水稻
- 变量类型包括：
  - `num`: 绝对人口数量
  - `len`: 团体数
  - `ratio`: 占总人口比例（什么尾缀都没加时默认使用这个）
  - `bkp`: 断点位置（年份，或tick数）
  - `pre`: 断点前的人口增长率
  - `post`: 断点后的人口增长率

### env

环境配置，包括环境参数，如环境容量、环境容量变化率等。

| 参数名 | 类型 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- |
| lim_h | float | 31.93 | 环境容量 |
| init_hunters | float | 0.05 | 初始狩猎采集者人口比例 |
| lam_farmer | float | 1 | 农民人口增长率 |
| lam_ricefarmer | float | 1 | 水稻农民人口增长率 |
| lim_g | int | 30 | 一般格子的上限 |
| tick_farmer | int | 0 | 农民加入世界的tick数 |
| tick_ricefarmer | int | 100 | 水稻农民加入世界的tick数 |

### time

时间配置，包括时间参数，如时间步数、时间步长等。

| 参数名 | 类型 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- |
| end | int | 10 | 时间步数 |

### farmer

农民配置，包括农民参数，如农民人口增长率、农民加入世界的tick数等。

| 参数名 | 类型 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- |
| area | int | 2 | 农民活动范围 |
| growth_rate | float | 0.004 | 农民人口增长率 |
| min_size | int | 6 | 最小农民群体数，小于这个数时会死掉 |
| new_group_size | list | [30, 60] | 新农民群体大小，第一个数是最小值，第二个数是最大值 |
| diffuse_prob | float | 0.05 | 农民扩散概率，每时间单位有x几率向外扩散新农民群体大小的农业殖民队 |
| complexity | float | 0.1 | 复杂化后人口增加速率下降多少 |
| convert_prob | dict | - | 转换概率，分别对应向狩猎采集者、水稻农民的转换概率 |
| convert_threshold | dict | - | 转换阈值，分别对应向狩猎采集者（超出xxx人不再转化为狩猎采集）、水稻农民（超出xxx人才能转化为水稻农民）的转换阈值 |
| max_travel_distance | int | 5 | 最大移动距离 |
| capital_area | float | 0.004 | 人均耕地面积 |
| loss | dict | - | 损失，分别对应损失概率、损失比率 |

### hunter

狩猎采集者配置，包括狩猎采集者参数，如狩猎采集者人口增长率、狩猎采集者加入世界的tick数等。

| 参数名 | 类型 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- |
| init_size | list | [0, 35] | 最初大小是多少，第一个数是最小值，第二个数是最大值。但注意设置最小值若小于群体能够生存的最小值的情况下，这个值也会自动变成理论最小值。即对于狩猎采集者而言，设置0的话，也会变成 min_size 的参数值 (默认为6) |
| growth_rate | float | 0.0008 | 狩猎采集者人口增长率 |
| min_size | int | 6 | 最小狩猎采集者群体数，小于这个数时会死掉 |
| intensified_coefficient | float | 1.5 | 狩猎采集者相对农民具有优势，在竞争中会乘以这个系数 |
| new_group_size | list | [6, 31] | 新狩猎采集者群体大小，第一个数是最小值，第二个数是最大值 |
| convert_prob | dict | - | 转换概率，分别对应向农民、水稻农民的转换概率 |
| max_travel_distance | int | 5 | 最大移动距离 |
| is_complex | int | 100 | 超过多少之后狩猎采集者不再移动 |

### ricefarmer

水稻农民配置，包括水稻农民参数，如水稻农民人口增长率、水稻农民加入世界的tick数等。

| 参数名 | 类型 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- |
| area | int | 2 | 水稻农民活动范围 |
| growth_rate | float | 0.005 | 水稻农民人口增长率 |
| min_size | int | 6 | 最小水稻农民群体数，小于这个数时会死掉 |
| new_group_size | list | [200, 300] | 新水稻农民群体大小，第一个数是最小值，第二个数是最大值 |
| diffuse_prob | float | 0.05 | 水稻农民扩散概率，每时间单位有x几率向外扩散新水稻农民群体大小的水稻农民殖民队 |
| complexity | float | 0.1 | 复杂化后人口增加速率下降多少 |
| convert_prob | dict | - | 转换概率，向农民转换概率，不能向狩猎采集者转换 |
| convert_threshold | dict | - | 转换阈值，即超出xxx人不再转化为农民 |
| max_travel_distance | int | 5 | 最大移动距离 |
| capital_area | float | 0.002 | 人均耕地面积 |
| loss | dict | - | 损失，分别对应损失概率、损失比率 |

### db

数据库配置，包括数据库参数，如数据库路径、数据库类型等。

| 参数名 | 类型 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- |
| dem | str | - | 数字高程模型路径 |
| slo | str | - | 土壤类型路径 |
| asp | str | - | 坡度路径 |
| farmland | str | - | 耕地路径 |
| lim_h | str | - | 环境容量路径 |

<!-- Links -->
  [断点检测方法]: ../tech/breakpoint.md#断点检测方法
  [断点数量]: ../tech/breakpoint.md#断点检测方法
  [绘制热图]: ./plots.md#绘制热图
